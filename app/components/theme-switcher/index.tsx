'use client'

import {PropsWithChildren, useEffect, useState} from 'react'
import {useTheme} from 'next-themes'
import FadeIn from '../fade-in'
import Tooltip from '../tooltip'
import styles from './theme.module.css'

export default function ThemeSwitcher({
  className = '',
  hideTooltip = false,
}: {
  className?: string
  hideTooltip?: boolean
}) {
  const {theme: activeTheme, setTheme} = useTheme()
  const [mounted, setMounted] = useState(false)

  useEffect(() => {
    setMounted(true)
  }, [])

  const Wrapper = ({children}: PropsWithChildren) =>
    hideTooltip ? (
      <>{children}</>
    ) : (
      <Tooltip text={activeTheme === 'light' ? 'Dark mode' : 'Light mode'}>{children}</Tooltip>
    )

  return (
    <Wrapper>
      <button
        onClick={() => setTheme(activeTheme === 'light' ? 'dark' : 'light')}
        aria-label='Change the theme'
        className={`${styles.themeSwitch} ${className}`}
      >
        {mounted ? (
          <FadeIn>
            {activeTheme === 'light' ? (
              <svg
                xmlns='http://www.w3.org/2000/svg'
                width='24'
                height='24'
                viewBox='0 0 24 24'
                fill='none'
              >
                <path
                  fill='#53cbc9'
                  d='M7.945 9.73a6.16 6.16 0 0 1 6.217-6.108a6.16 6.16 0 0 1 6.215 6.108a.38.38 0 0 1-.378.379H8.324a.38.38 0 0 1-.379-.379'
                ></path>
                <path
                  fill='#cb1f7a'
                  d='M6.324 11.73c0-.297.2-.54.45-.54H21.01c.249 0 .448.243.448.54s-.2.54-.448.54H6.773c-.248 0-.449-.243-.449-.54m-2.703 1.62c0-.297.206-.54.454-.54h10.443c.25 0 .454.243.454.54s-.204.542-.454.542H4.075c-.248 0-.454-.244-.454-.542m3.157 1.081c-.248 0-.454.244-.454.541s.206.54.454.54h12.606c.249 0 .454-.242.454-.54c0-.297-.205-.54-.454-.54zm-2.616 2.162c0-.296.211-.54.466-.54h5.016c.253 0 .464.244.464.54c0 .298-.21.543-.464.543H4.628c-.255 0-.466-.245-.466-.543m9.086 1.082c-.243 0-.437.242-.437.54s.194.541.437.541h6.158c.243 0 .437-.243.437-.54s-.194-.54-.437-.54h-6.163zm-4.221 2.162c0-.298.194-.541.438-.541h6.157c.243 0 .438.243.438.541s-.195.54-.438.54H9.46c-.244 0-.438-.242-.438-.54zm2.081-3.784c-.254 0-.46.244-.46.54c0 .298.207.543.46.543h10.433c.253 0 .459-.245.459-.543c0-.296-.206-.54-.46-.54zm-6.405-4.326a.54.54 0 1 1 1.08-.052a.54.54 0 0 1-1.08.052M2.54 12.81a.542.542 0 1 0 0 1.083a.542.542 0 0 0 0-1.083m2.163 2.163a.54.54 0 1 1 1.08-.052a.54.54 0 0 1-1.08.052m-1.621 1.082a.54.54 0 1 0 0 1.082a.54.54 0 0 0 0-1.082m8.107 2.162a.54.54 0 1 1 1.08 0a.54.54 0 0 1-1.08 0m-3.243 1.081a.54.54 0 0 0-.523.754a.542.542 0 1 0 .523-.754'
                ></path>
              </svg>
            ) : (
              <svg
                xmlns='http://www.w3.org/2000/svg'
                width='24'
                height='24'
                viewBox='0 0 24 24'
                fill='none'
              >
                <path
                  fill='#f2b705'
                  d='M20.176 11.233a8.237 8.237 0 1 0-16.327.194a6.64 6.64 0 0 1 4.442-1.784a8.24 8.24 0 0 1 4.695 1.572a5.88 5.88 0 0 0 4.047 1.164a7 7 0 0 0 3.137-1.153z'
                ></path>
                <path
                  fill='#52cac7'
                  d='M5.526 14.35c0-.275.265-.588.59-.588c.323 0 .588.313.588.589v2.93c0 .277-.265.6-.589.6s-.589-.323-.589-.6zm5.297-.588c0-.27.263-.588.587-.588s.59.318.59.588v2.942c0 .272-.266.589-.59.589s-.587-.319-.587-.59zm1.764 1.178c0-.254.265-.59.588-.59c.324 0 .59.336.59.59v.587c0 .253-.266.59-.59.59s-.588-.337-.588-.59zm5.294.587c0-.299.265-.587.59-.587c.323 0 .588.288.588.587v1.766a.604.604 0 0 1-.589.587a.605.605 0 0 1-.587-.587zm-10.59-1.765c0-.264.266-.588.59-.588c.322 0 .587.324.587.588v4.149c0 .264-.265.558-.587.558c-.324 0-.59-.294-.59-.558zm7.061 1.765a.61.61 0 0 1 .589-.587a.61.61 0 0 1 .587.587v4.708a.61.61 0 0 1-.587.587a.61.61 0 0 1-.589-.587zm1.765.59c0-.27.265-.588.588-.588c.324 0 .589.318.589.589v3.528c0 .27-.265.589-.589.589s-.588-.319-.588-.59zm-7.06-2.941c0-.276.265-.59.59-.59c.322 0 .587.314.587.59v8.237c0 .276-.265.587-.588.587c-.324 0-.59-.311-.59-.587z'
                ></path>
                <path
                  fill='#52cac7'
                  d='M8.857 11.88a5.77 5.77 0 0 0-4.219 1.495a.536.536 0 0 1-.847-.235a.51.51 0 0 1 .16-.555a6.82 6.82 0 0 1 7.824-.94a7 7 0 0 1 1.066.741l.293.217a6 6 0 0 0 3.236 1.012c1.33.012 2.489-.742 3.019-1.129a.53.53 0 0 1 .831.283a.51.51 0 0 1-.196.547c-.553.411-1.96 1.353-3.665 1.34a7.14 7.14 0 0 1-3.825-1.194l-.394-.293l-.177-.142a5.5 5.5 0 0 0-3.106-1.153z'
                ></path>
              </svg>
            )}
          </FadeIn>
        ) : (
          <span style={{opacity: 0}} aria-hidden></span>
        )}
      </button>
    </Wrapper>
  )
}
